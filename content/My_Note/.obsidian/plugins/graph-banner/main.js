var H=Object.create;var E=Object.defineProperty;var W=Object.getOwnPropertyDescriptor;var j=Object.getOwnPropertyNames;var K=Object.getPrototypeOf,z=Object.prototype.hasOwnProperty;var U=(s,e,t)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Y=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),q=(s,e)=>{for(var t in e)E(s,t,{get:e[t],enumerable:!0})},x=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of j(e))!z.call(s,n)&&n!==t&&E(s,n,{get:()=>e[n],enumerable:!(i=W(e,n))||i.enumerable});return s};var J=(s,e,t)=>(t=s!=null?H(K(s)):{},x(e||!s||!s.__esModule?E(t,"default",{value:s,enumerable:!0}):t,s)),Q=s=>x(E({},"__esModule",{value:!0}),s);var h=(s,e,t)=>U(s,typeof e!="symbol"?e+"":e,t);var c=(s,e,t)=>new Promise((i,n)=>{var r=a=>{try{p(t.next(a))}catch(l){n(l)}},o=a=>{try{p(t.throw(a))}catch(l){n(l)}},p=a=>a.done?i(a.value):Promise.resolve(a.value).then(r,o);p((t=t.apply(s,e)).next())});var B=Y((ye,b)=>{function I(s){return Array.isArray(s)?s:[s]}var Z=void 0,L="",$=" ",T="\\",ee=/^\s+$/,te=/(?:[^\\]|^)\\$/,se=/^\\!/,ie=/^\\#/,ne=/\r?\n/g,re=/^\.{0,2}\/|^\.{1,2}$/,oe=/\/$/,u="/",D="node-ignore";typeof Symbol!="undefined"&&(D=Symbol.for("node-ignore"));var O=D,_=(s,e,t)=>(Object.defineProperty(s,e,{value:t}),t),ae=/([0-z])-([0-z])/g,X=()=>!1,ce=s=>s.replace(ae,(e,t,i)=>t.charCodeAt(0)<=i.charCodeAt(0)?e:L),he=s=>{let{length:e}=s;return s.slice(0,e-e%2)},le=[[/^\uFEFF/,()=>L],[/((?:\\\\)*?)(\\?\s+)$/,(s,e,t)=>e+(t.indexOf("\\")===0?$:L)],[/(\\+?)\s/g,(s,e)=>{let{length:t}=e;return e.slice(0,t-t%2)+$}],[/[\\$.|*+(){^]/g,s=>`\\${s}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(s,e,t)=>e+6<t.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(s,e,t)=>{let i=t.replace(/\\\*/g,"[^\\/]*");return e+i}],[/\\\\\\(?=[$.|*+(){^])/g,()=>T],[/\\\\/g,()=>T],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(s,e,t,i,n)=>e===T?`\\[${t}${he(i)}${n}`:n==="]"&&i.length%2===0?`[${ce(t)}${i}]`:"[]"],[/(?:[^*])$/,s=>/\/$/.test(s)?`${s}$`:`${s}(?=$|\\/$)`]],de=/(^|\\\/)?\\\*$/,m="regex",A="checkRegex",V="_",pe={[m](s,e){return`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`},[A](s,e){return`${e?`${e}[^/]*`:"[^/]*"}(?=$|\\/$)`}},ge=s=>le.reduce((e,[t,i])=>e.replace(t,i.bind(s)),s),v=s=>typeof s=="string",fe=s=>s&&v(s)&&!ee.test(s)&&!te.test(s)&&s.indexOf("#")!==0,ue=s=>s.split(ne).filter(Boolean),S=class{constructor(e,t,i,n,r,o){this.pattern=e,this.mark=t,this.negative=r,_(this,"body",i),_(this,"ignoreCase",n),_(this,"regexPrefix",o)}get regex(){let e=V+m;return this[e]?this[e]:this._make(m,e)}get checkRegex(){let e=V+A;return this[e]?this[e]:this._make(A,e)}_make(e,t){let i=this.regexPrefix.replace(de,pe[e]),n=this.ignoreCase?new RegExp(i,"i"):new RegExp(i);return _(this,t,n)}},Ee=({pattern:s,mark:e},t)=>{let i=!1,n=s;n.indexOf("!")===0&&(i=!0,n=n.substr(1)),n=n.replace(se,"!").replace(ie,"#");let r=ge(n);return new S(s,e,n,t,i,r)},N=class{constructor(e){this._ignoreCase=e,this._rules=[]}_add(e){if(e&&e[O]){this._rules=this._rules.concat(e._rules._rules),this._added=!0;return}if(v(e)&&(e={pattern:e}),fe(e.pattern)){let t=Ee(e,this._ignoreCase);this._added=!0,this._rules.push(t)}}add(e){return this._added=!1,I(v(e)?ue(e):e).forEach(this._add,this),this._added}test(e,t,i){let n=!1,r=!1,o;this._rules.forEach(a=>{let{negative:l}=a;r===l&&n!==r||l&&!n&&!r&&!t||!a[i].test(e)||(n=!l,r=l,o=l?Z:a)});let p={ignored:n,unignored:r};return o&&(p.rule=o),p}},_e=(s,e)=>{throw new e(s)},d=(s,e,t)=>v(s)?s?d.isNotRelative(s)?t(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:t("path must not be empty",TypeError):t(`path must be a string, but got \`${e}\``,TypeError),M=s=>re.test(s);d.isNotRelative=M;d.convert=s=>s;var P=class{constructor({ignorecase:e=!0,ignoreCase:t=e,allowRelativePaths:i=!1}={}){_(this,O,!0),this._rules=new N(t),this._strictPathCheck=!i,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}add(e){return this._rules.add(e)&&this._initCache(),this}addPattern(e){return this.add(e)}_test(e,t,i,n){let r=e&&d.convert(e);return d(r,e,this._strictPathCheck?_e:X),this._t(r,t,i,n)}checkIgnore(e){if(!oe.test(e))return this.test(e);let t=e.split(u).filter(Boolean);if(t.pop(),t.length){let i=this._t(t.join(u)+u,this._testCache,!0,t);if(i.ignored)return i}return this._rules.test(e,!1,A)}_t(e,t,i,n){if(e in t)return t[e];if(n||(n=e.split(u).filter(Boolean)),n.pop(),!n.length)return t[e]=this._rules.test(e,i,m);let r=this._t(n.join(u)+u,t,i,n);return t[e]=r.ignored?r:this._rules.test(e,i,m)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return I(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}},G=s=>new P(s),me=s=>d(s&&d.convert(s),s,X);if(typeof process!="undefined"&&(process.env&&process.env.IGNORE_TEST_WIN32||process.platform==="win32")){let s=t=>/^\\\\\?\\/.test(t)||/["<>|\u0000-\u001F]+/u.test(t)?t:t.replace(/\\/g,"/");d.convert=s;let e=/^[a-z]:\//i;d.isNotRelative=t=>e.test(t)||M(t)}b.exports=G;G.default=G;b.exports.isPathValid=me});var we={};q(we,{default:()=>C});module.exports=Q(we);var F=J(B()),w=require("obsidian");var g=require("obsidian");var k={ignore:[],timeToRemoveLeaf:100},y=class extends g.PluginSettingTab{constructor(t,i){super(t,i);h(this,"plugin");this.plugin=i}display(){let{containerEl:t}=this;t.empty(),new g.Setting(t).setName("Ignored path pattern").setDesc("Manage notes which do not display the graph banner. This pattern follows .gitignore spec.").addTextArea(i=>i.setPlaceholder(`ignored-path.md
/ignored-dir
!/ignored-dir/not-ignored-path.md`).setValue(this.plugin.settings.ignore.join(`
`)).onChange(n=>c(this,null,function*(){this.plugin.settings.ignore=n.split(`
`),yield this.plugin.saveData(this.plugin.settings)}))),new g.Setting(t).setName("Advanced: Time [ms] to remove the graph leaf for the banner").setDesc(`This plugin temporarily create a local graph leaf to display in the banner of the notes.
If you want to do something when the local graph opened, for example by using the "Sync Graph Settings" plugin, set this time settings.
If set to 0ms, the leaf is immediately erased.
To reflect this setting, please reload the app.`).addText(i=>i.setPlaceholder("100").setValue(String(this.plugin.settings.timeToRemoveLeaf)).onChange(n=>c(this,null,function*(){let r=Number(n);(n===""||Number.isNaN(r)||r<0)&&new g.Notice("Please specify a valid number."),this.plugin.settings.timeToRemoveLeaf=r,yield this.plugin.saveData(this.plugin.settings)})))}};var f=class f{constructor(e,t){h(this,"leaf");h(this,"node");h(this,"setupLeafPromise");this.leaf=e.workspace.getLeaf("tab"),this.setupLeafPromise=this.setupLeaf(t.settings.timeToRemoveLeaf);let i=this.leaf.view.containerEl.find(".view-content");this.node=i,this.setupNode()}setupLeaf(e){return c(this,null,function*(){yield this.leaf.setViewState({type:"localgraph"});let t=()=>this.leaf.parent.removeChild(this.leaf);e>0?setTimeout(t,e):t()})}setupNode(){var t;this.node.addClass(f.nodeClass),(t=this.node.find(".graph-controls"))==null||t.toggleClass("is-close",!0);let e=document.createElement("div");e.addClass(f.overlayNodeClass),this.node.insertBefore(e,this.node.querySelector("canvas")),e.addEventListener("pointerup",()=>{if(this.isActive())return;this.setActive(!0);let i=new AbortController;document.addEventListener("pointerdown",n=>{this.isActive()&&(n.target&&this.node.contains(n.target)||(this.setActive(!1),i.abort()))},{signal:i.signal})})}isActive(){return this.node.dataset.interactive==="true"}setActive(e){this.node.dataset.interactive=e.toString()}placeTo(e){return c(this,null,function*(){yield this.setupLeafPromise,yield this.leaf.setViewState({type:"localgraph",state:{file:e.file.path}}),this.leaf.setGroup(e.file.path);let t=e.getMode(),i=e.containerEl.find(`.markdown-${t}-view`);if(this.isDescendantOf(i))return;let n=i.find(".inline-title"),r=n.parentElement;if(!r)throw"Failed to get note header";r.insertAfter(this.node,n)})}isDescendantOf(e){return e.contains(this.node)}setVisibility(e){this.node.toggleClass("hidden",!e)}detach(){this.leaf.detach(),this.node.removeClass(f.nodeClass)}};h(f,"nodeClass","graph-banner-content"),h(f,"overlayNodeClass","graph-banner-overlay");var R=f;var C=class extends w.Plugin{constructor(){super(...arguments);h(this,"settings",k);h(this,"graphViews",[])}onload(){return c(this,null,function*(){yield this.loadSettings(),this.addSettingTab(new y(this.app,this)),this.app.workspace.trigger("parse-style-settings"),this.registerEvent(this.app.workspace.on("file-open",i=>c(this,null,function*(){if(!i||i.extension!=="md")return;let n=this.app.workspace.getActiveViewOfType(w.MarkdownView);!n||n.file!==i||(yield this.placeGraphView(n))}))),this.registerEvent(this.app.workspace.on("layout-change",()=>c(this,null,function*(){let i=this.app.workspace.getActiveViewOfType(w.MarkdownView);i&&(yield this.placeGraphView(i))})));let t=this.app.workspace.getLeavesOfType("markdown");for(let i of t)this.placeGraphView(i.view)})}onunload(){for(let t of this.graphViews)t.detach();this.graphViews=[]}loadSettings(){return c(this,null,function*(){this.settings=Object.assign({},k,yield this.loadData())})}placeGraphView(t){return c(this,null,function*(){let i=(0,F.default)().add(this.settings.ignore).ignores(t.file.path),n=this.findAvailableGraphView(t);n.setVisibility(!i),yield n.placeTo(t)})}findAvailableGraphView(t){let i=this.graphViews.find(o=>o.isDescendantOf(t.containerEl));if(i!==void 0)return i;let n=this.app.workspace.getLeavesOfType("markdown").map(o=>o.view.containerEl);for(let o of this.graphViews)if(!n.some(a=>o.isDescendantOf(a)))return o;let r=new R(this.app,this);return this.graphViews.push(r),r}};

/* nosourcemap */